<!DOCTYPE html>
<html lang="<%= I18n.locale %>">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <%-
    title = content_for?(:page_title) ? ("#{yield(:page_title)} | #{t('app.common.app_name')}").html_safe :
      t('app.common.app_name').html_safe

    desc = t('app.common.app_description')
  -%>

  <title><%= title %></title>


  <meta property="og:title" content="<%= title %>">
  <meta name="description" content="<%= desc %>">
  <meta property="og:description" content="<%= desc %>" />
  <meta property="og:type" content="non_profit" />
  <meta property="og:url" content="<%= current_url %>" />
  <meta property="og:site_name" content="<%= t("app.common.app_name") %>" />


  <%= csrf_meta_tags %>

  <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if lt IE 9]>

    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
  <![endif]-->

  <%= stylesheet_link_tag "application", :media => "all" %>

  <!-- For third-generation iPad with high-resolution Retina display: -->
  <!-- Size should be 144 x 144 pixels -->
  <%= favicon_link_tag 'apple-touch-icon-144x144-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png', :sizes => '144x144' %>

  <!-- For iPhone with high-resolution Retina display: -->
  <!-- Size should be 114 x 114 pixels -->
  <%= favicon_link_tag 'apple-touch-icon-114x114-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png', :sizes => '114x114' %>

  <!-- For first- and second-generation iPad: -->
  <!-- Size should be 72 x 72 pixels -->
  <%= favicon_link_tag 'apple-touch-icon-72x72-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png', :sizes => '72x72' %>

  <!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
  <!-- Size should be 57 x 57 pixels -->
  <%= favicon_link_tag 'apple-touch-icon-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png' %>

  <!-- For all other devices -->
  <!-- Size should be 32 x 32 pixels -->
  <!--favicon_link_tag 'favicon.ico', :rel => 'shortcut icon'-->

  <%= javascript_include_tag "application", 'data-turbolinks-track' => true %>

  <% if Rails.env.production? %>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-12801815-45', 'auto');
      ga('send', 'pageview');

    </script>
  <% end %>
</head>
<body class="<%= controller_name %> <%= action_name %>">
    <% if Rails.env.production? %>
      <!-- Makes google analytics work when changing pages via Turbolinks.
           Source:
           https://coderwall.com/p/ypzfdw/faster-page-loads-with-turbolinks -->
      <script>_gaq.push(['_trackPageview']);</script>
    <% end %>

    <%= include_gon %>

    <div class="loading-indicator">
      <%= image_tag('loading_apple.gif') %>
    </div>

    <div class="navbar navbar-default navbar-static-top">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
            <a class="navbar-brand" href="<%= root_path %>"><%= t('app.common.app_name') %></a>
          </div>
            <div class="navbar-collapse collapse navbar-responsive-collapse">
                <ul class="nav navbar-nav navbar-right">
                  <li class='li-search'>
                    <form action="<%= prisoners_path %>" method="get" id="search-form" class="navbar-form navbar-left" role="search">
                      <div class="form-group">
                        <%= text_field_tag :q, nil, :placeholder => 'Search Prisoners', :class=>"form-control search-input", :autocomplete=>'off', :tabindex => 1 %>
                      </div>
                    </form>
                  </li>
                  <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                      Find By <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu" role="menu">
                      <li><%= link_to "Name", prisoners_path  %></li>
                      <li><%= link_to "Prison", prisons_path  %></li>
                      <li><%= link_to "Arrest Charge", articles_path  %></li>
                      <li><%= link_to "Category", tags_path  %></li>
                    </ul>
                  </li>

                  <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                      About <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu" role="menu">
                      <li><%= link_to "About Site", about_path %></li>
                      <li><%= link_to "Methodology", methodology_path %></li>
                      <li><%= link_to "Disclaimer", disclaimer_path %></li>
                    </ul>
                  </li>

                  <li>
                    <%= link_to csv_zip_path, title: "Download Latest Data" do %>
                      <i class="fa fa-download"></i>
                    <% end %>
                  </li>

                  <!-- <% if Rails.env.production? || Rails.env.staging? %> -->
                    <li>
                      <!-- Go to www.addthis.com/dashboard to customize your tools -->
                      <div class="addthis_toolbox addthis_default_style addthis_20x20_style">
                        <a class="addthis_button_preferred_1"></a>
                        <a class="addthis_button_preferred_2"></a>
                        <a class="addthis_button_compact"></a>
                      </div>
                    </li>
                  <!-- <% end %> -->

                  <% if user_signed_in? %>
                    <li class="dropdown">
                        <a href="#" id="user-dropdown" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                          <i class="fa fa-user"></i>
                          <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu" role="menu">
                          <li><%= link_to "Prisoners", prisoners_path  %></li>
                          <li><%= link_to "Prisons", prisons_path  %></li>
                          <li><%= link_to "Articles", articles_path  %></li>
                          <li><%= link_to "Tags", tags_path  %></li>
                          <li><%= link_to "Criminal Codes", criminal_codes_path  %></li>
                          <% if can? :read, User %><li><%= link_to "Users", users_path %></li><% end %>
                          <li class="divider"></li>
                          <li><%= link_to 'Edit profile', edit_user_registration_path %></li>
                          <li class="divider"></li>
                          <li><%= link_to "Logout", destroy_user_session_path, method: :delete %></li>
                        </ul>
                    </li>
                  <% end %>
                </ul>
                <!-- <ul class="nav navbar-nav navbar-right">
                  <% I18n.available_locales.each do |locale| %>
                    <% if locale != I18n.locale %>
                      <li><%= link_to t("app.language.#{locale}"), params.merge(:locale => locale) %></li>
                    <% end %>
                  <% end %>
                </ul> -->
            </div>
        </div>
    </div>

    <div class="container">
        <div>
          <% if Rails.env.staging? %>
            <div class="alert alert-danger">
              5 June 2015 - Please use <a href="http://prisoners.watch">prisoners.watch</a> to enter data from now on.

            </div>
          <% end %>


            <%= bootstrap_flash %>

            <% if @show_page_title && content_for?(:page_title) %>
              <div id="page-header">
                <% if (content_for? :page_subtitle) %>
                  <hgroup>
                      <h1><%= yield(:page_title) %><span id="page-title-right" class="pull-right"><%= yield(:page_title_right) %></span></h1>
                      <h2><%= yield(:page_subtitle) %></h2>
                  </hgroup>
                <% else %>
                    <h1><%= yield(:page_title) %></h1><div class="actions"><%= yield(:page_title_right) %></div>
                  </div>
                <% end %>
              </div>
            <% end %>


            <%= yield %>


        </div>
    </div>

    <footer class="clear">
      <div id="left">&copy; <%= Time.now.year %></div>
      <div id="middle">
        <%= link_to "Disclaimer", disclaimer_path %>
      </div>
      <div id="right" class="clear">
        <%= link_to(image_tag("jumpstart-logo.png"), "http://www.jumpstart.ge", :target => "_blank",
            :title => t('app.common.js_link_title') ) %>
      </div>
    </footer>
  </body>
</html>
